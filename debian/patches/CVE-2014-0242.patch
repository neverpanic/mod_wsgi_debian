From b0a149c1f5e569932325972e2e20176a42e43517 Mon Sep 17 00:00:00 2001
From: Graham Dumpleton <Graham.Dumpleton@gmail.com>
Date: Mon, 7 May 2012 13:23:15 +1000
Subject: [PATCH] Fix bug where content type returned for response could be
 corrupted when using embedded mode.

---
 mod_wsgi.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/mod_wsgi.c b/mod_wsgi.c
index 45be2bc..71cab77 100644
--- a/mod_wsgi.c
+++ b/mod_wsgi.c
@@ -3252,7 +3252,7 @@ static int Adapter_output(AdapterObject *self, const char *data, int length,
                 if (*self->config->process_group)
                     r->content_type = apr_pstrdup(r->pool, value);
                 else
-                    ap_set_content_type(r, value);
+                    ap_set_content_type(r, apr_pstrdup(r->pool, value));
 #endif
             }
             else if (!strcasecmp(name, "Content-Length")) {
-- 
1.9.3
